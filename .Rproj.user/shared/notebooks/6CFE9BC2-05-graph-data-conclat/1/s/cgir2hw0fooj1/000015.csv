"0","# Calcular proporciones ponderadas solo por clase social"
"0","tabla_total <- data_svy %>%"
"0","  filter(!is.na(wrightclass1_reduced)) %>% "
"0","  group_by(wrightclass1_reduced) %>%"
"0","  summarise(prop = survey_mean(vartype = NULL, proportion = TRUE)) %>%"
"0","  ungroup()"
"0",""
"0","# Gráfico"
"0","ggplot(tabla_total, aes(x = wrightclass1_reduced, y = prop)) +"
"0","  geom_col(fill = ""#9e1b1e"") +"
"0","  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +"
"0","  geom_text("
"0","    aes(label = paste0(round(prop * 100, 1), ""%"")),"
"0","    vjust = -0.3,"
"0","    color = ""black"","
"0","    size = 3"
"0","  ) +"
"0","  labs("
"0","    title = ""Distribución de la población por clase social"","
"0","    caption = ""Nota: Datos ponderados."","
"0","    x = ""Clase social"","
"0","    y = ""Porcentaje"""
"0","  ) +"
"0","  theme_minimal() +"
"0","  theme(axis.text.x = element_text(angle = 45, hjust = 1))"
