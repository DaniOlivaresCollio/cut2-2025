{
  "hash": "3268acec533579b49ac769629c7dc6b3",
  "result": {
    "engine": "knitr",
    "markdown": "# Gráficos 2: Edad x sexo, primera versión\n\n\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n\n\n## Cargar datos\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload(\"output/data/datos-cut.Rdata\")\n\n# base survey\ndata_svy <- as_survey_design(data, weights = rake_wb2)\n```\n:::\n\n\n\n\n\n\n## Gráficos\n\n### c01_01 x sexo x edad\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calcular promedios por sexo y edad\npromedios_sexo_edad <- data_svy %>%\n  filter(\n    !is.na(c01_01),\n    !is.na(sexo),\n    !is.na(edad_tramos)\n  ) %>%\n  group_by(edad_tramos, sexo) %>%\n  summarise(\n    promedio = survey_mean(c01_01, na.rm = TRUE)\n  )\n\n# Graficar barras agrupadas\nggplot(promedios_sexo_edad, aes(x = edad_tramos, y = promedio, fill = sexo)) +\n  geom_col(position = position_dodge(width = 0.8)) +\n  geom_text(\n    aes(label = round(promedio, 1)),\n    position = position_dodge(width = 0.8),\n    vjust = 1.3,\n    color = \"white\",\n    size = 4\n  ) +\n  scale_fill_manual(values = c(\"Mujer\" = \"#f25f5c\", \"Hombre\" = \"#9e1b1e\")) +\n  labs(\n    title = \"Importancia de los sindicatos para: \\nConseguir mejores salarios y condiciones laborales para los trabajadores\",\n    subtitle = \"Promedio ponderado según sexo y tramo etario\",\n    caption = \"Nota: Datos ponderados. N = 3048.\",\n    x = \"Tramo de edad\",\n    y = \"Promedio (escala 0-10)\",\n    fill = \"Sexo\"\n  ) +\n  ylim(0, 10) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03-graph-data-conclat_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Guardar\nggsave(\"output/graph2/c01_01_sexo_edad.png\", width = 9, height = 6, dpi = 300)\n```\n:::\n\n\n\n\n\n\n### c01_02 x sexo x edad\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calcular promedios por sexo y edad\npromedios_c01_02 <- data_svy %>%\n  filter(\n    !is.na(c01_02),\n    !is.na(sexo),\n    !is.na(edad_tramos)\n  ) %>%\n  group_by(edad_tramos, sexo) %>%\n  summarise(\n    promedio = survey_mean(c01_02, na.rm = TRUE)\n  )\n\n# Graficar\nggplot(promedios_c01_02, aes(x = edad_tramos, y = promedio, fill = sexo)) +\n  geom_col(position = position_dodge(width = 0.8)) +\n  geom_text(\n    aes(label = round(promedio, 1)),\n    position = position_dodge(width = 0.8),\n    vjust = 1.3,\n    color = \"white\",\n    size = 4\n  ) +\n  scale_fill_manual(values = c(\"Mujer\" = \"#f25f5c\", \"Hombre\" = \"#9e1b1e\")) +\n  labs(\n    title = \"Importancia de los sindicatos para: \\nReducir la desigualdad de ingresos en el país\",\n    subtitle = \"Promedio ponderado según sexo y tramo etario\",\n    caption = \"Nota: Datos ponderados. N = 3048.\",\n    x = \"Tramo de edad\",\n    y = \"Promedio (escala 0-10)\",\n    fill = \"Sexo\"\n  ) +\n  ylim(0, 10) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03-graph-data-conclat_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Guardar\nggsave(\"output/graph2/c01_02_sexo_edad.png\", width = 9, height = 6, dpi = 300)\n```\n:::\n\n\n\n\n\n\n### c05_02 x sexo x edad\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calcular proporciones por sexo y edad\nacuerdo_sexo_edad <- data_svy %>%\n  filter(\n    !is.na(sexo),\n    !is.na(edad_tramos),\n    !is.na(c05_02_acuerdo)\n  ) %>%\n  group_by(edad_tramos, sexo) %>%\n  summarise(\n    prop_acuerdo = survey_mean(c05_02_acuerdo, na.rm = TRUE)\n  )\n\n# Graficar: barras separadas por sexo (cada grupo suma 100%)\nggplot(acuerdo_sexo_edad, aes(x = edad_tramos, y = prop_acuerdo, fill = sexo)) +\n  geom_col(position = position_dodge(width = 0.8)) +\n  geom_text(\n    aes(label = scales::percent(prop_acuerdo, accuracy = 0.1)),\n    position = position_dodge(width = 0.8),\n    vjust = 1.3,\n    size = 4,\n    color = \"white\"\n  ) +\n  scale_fill_manual(values = c(\"Mujer\" = \"#f25f5c\", \"Hombre\" = \"#9e1b1e\")) +\n  scale_y_continuous(labels = scales::percent_format(accuracy = 1), expand = expansion(mult = c(0, 0.1))) +\n  labs(\n    title = \"Acuerdo con: Una de las principales razones de la alta desigualdad en Chile \\nes que los dueños de las empresas pagan poco a sus trabajadores\",\n    subtitle = \"Porcentaje según sexo y tramo etario\",\n    caption = \"Nota: Datos ponderados. Proporción que responde De acuerdo (4) o Muy de acuerdo (5). N = 3048.\",\n    x = \"Tramo de edad\",\n    y = \"Porcentaje\",\n    fill = \"Sexo\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03-graph-data-conclat_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Guardar gráfico\nggsave(\"output/graph2/c05_02_sexo_edad.png\", width = 9, height = 6, dpi = 300)\n```\n:::\n\n\n\n\n\n\n### c05_03 x sexo x edad\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calcular proporciones por sexo y edad\nacuerdo_sexo_edad <- data_svy %>%\n  filter(\n    !is.na(sexo),\n    !is.na(edad_tramos),\n    !is.na(c05_03_acuerdo)\n  ) %>%\n  group_by(edad_tramos, sexo) %>%\n  summarise(\n    prop_acuerdo = survey_mean(c05_03_acuerdo, na.rm = TRUE)\n  )\n\n# Graficar\nggplot(acuerdo_sexo_edad, aes(x = edad_tramos, y = prop_acuerdo, fill = sexo)) +\n  geom_col(position = position_dodge(width = 0.8)) +\n  geom_text(\n    aes(label = scales::percent(prop_acuerdo, accuracy = 0.1)),\n    position = position_dodge(width = 0.8),\n    vjust = 1.3,\n    color = \"white\",\n    size = 4\n  ) +\n  scale_fill_manual(values = c(\"Mujer\" = \"#f25f5c\", \"Hombre\" = \"#9e1b1e\")) +\n  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +\n  labs(\n    title = \"Acuerdo con: El alto nivel de vida de los dueños de las empresas es resultado \\nde lo poco que pagan a sus trabajadores\",\n    subtitle = \"Porcentaje según sexo y tramo etario\",\n    caption = \"Nota: Datos ponderados. Proporción que responde De acuerdo (4) o Muy de acuerdo (5). N = 3048.\",\n    x = \"Tramo de edad\",\n    y = \"Porcentaje de acuerdo\",\n    fill = \"Sexo\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03-graph-data-conclat_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Guardar gráfico\nggsave(\"output/graph2/c05_03_sexo_edad.png\", width = 9, height = 6, dpi = 300)\n```\n:::\n\n\n\n\n\n\n### c06_02 x sexo x edad\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calcular proporciones por sexo y edad\nacuerdo_sexo_edad <- data_svy %>%\n  filter(\n    !is.na(sexo),\n    !is.na(edad_tramos),\n    !is.na(c06_02_acuerdo)\n  ) %>%\n  group_by(edad_tramos, sexo) %>%\n  summarise(\n    prop_acuerdo = survey_mean(c06_02_acuerdo, na.rm = TRUE)\n  )\n\n# Graficar\nggplot(acuerdo_sexo_edad, aes(x = edad_tramos, y = prop_acuerdo, fill = sexo)) +\n  geom_col(position = position_dodge(width = 0.8)) +\n  geom_text(\n    aes(label = scales::percent(prop_acuerdo, accuracy = 0.1)),\n    position = position_dodge(width = 0.8),\n    vjust = 1.3,\n    color = \"white\",\n    size = 4\n  ) +\n  scale_fill_manual(values = c(\"Mujer\" = \"#f25f5c\", \"Hombre\" = \"#9e1b1e\")) +\n  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +\n  labs(\n    title = \"Acuerdo con: Apoyaría una reforma para crear un sistema solidario de reparto \\nsi eso permite subir las pensiones\",\n    subtitle = \"Porcentaje según sexo y tramo etario\",\n    caption = \"Nota: Datos ponderados. Proporción que responde De acuerdo (4) o Muy de acuerdo (5). N = 3048.\",\n    x = \"Tramo de edad\",\n    y = \"Porcentaje de acuerdo\",\n    fill = \"Sexo\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03-graph-data-conclat_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Guardar gráfico\nggsave(\"output/graph2/c06_02_sexo_edad.png\", width = 9, height = 6, dpi = 300)\n```\n:::\n\n\n\n\n\n\n### c07_01 x sexo x edad\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calcular proporciones por sexo y edad\nacuerdo_sexo_edad <- data_svy %>%\n  filter(\n    !is.na(sexo),\n    !is.na(edad_tramos),\n    !is.na(c07_01_acuerdo)\n  ) %>%\n  group_by(edad_tramos, sexo) %>%\n  summarise(\n    prop_acuerdo = survey_mean(c07_01_acuerdo, na.rm = TRUE)\n  )\n\n# Graficar\nggplot(acuerdo_sexo_edad, aes(x = edad_tramos, y = prop_acuerdo, fill = sexo)) +\n  geom_col(position = position_dodge(width = 0.8)) +\n  geom_text(\n    aes(label = scales::percent(prop_acuerdo, accuracy = 0.1)),\n    position = position_dodge(width = 0.8),\n    vjust = 1.3,\n    color = \"white\",\n    size = 4\n  ) +\n  scale_fill_manual(values = c(\"Mujer\" = \"#f25f5c\", \"Hombre\" = \"#9e1b1e\")) +\n  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +\n  labs(\n    title = \"Acuerdo con: Aumentar los impuestos a los más ricos para financiar \\nprogramas sociales\",\n    subtitle = \"Porcentaje según sexo y tramo etario\",\n    caption = \"Nota: Datos ponderados. Proporción que responde De acuerdo (4) o Muy de acuerdo (5). N = 3048.\",\n    x = \"Tramo de edad\",\n    y = \"Porcentaje de acuerdo\",\n    fill = \"Sexo\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03-graph-data-conclat_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Guardar gráfico\nggsave(\"output/graph2/c07_01_sexo_edad.png\", width = 9, height = 6, dpi = 300)\n```\n:::\n\n\n\n\n\n\n### c07_03 x sexo x edad\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calcular proporciones por sexo y edad\nacuerdo_sexo_edad <- data_svy %>%\n  filter(\n    !is.na(sexo),\n    !is.na(edad_tramos),\n    !is.na(c07_03_acuerdo)\n  ) %>%\n  group_by(edad_tramos, sexo) %>%\n  summarise(\n    prop_acuerdo = survey_mean(c07_03_acuerdo, na.rm = TRUE)\n  )\n\n# Graficar\nggplot(acuerdo_sexo_edad, aes(x = edad_tramos, y = prop_acuerdo, fill = sexo)) +\n  geom_col(position = position_dodge(width = 0.8)) +\n  geom_text(\n    aes(label = scales::percent(prop_acuerdo, accuracy = 0.1)),\n    position = position_dodge(width = 0.8),\n    vjust = 1.3,\n    color = \"white\",\n    size = 4\n  ) +\n  scale_fill_manual(values = c(\"Mujer\" = \"#f25f5c\", \"Hombre\" = \"#9e1b1e\")) +\n  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +\n  labs(\n    title = \"Acuerdo con: Implementar leyes para que los sindicatos tengan más poder \\nde negociación\",\n    subtitle = \"Porcentaje según sexo y tramo etario\",\n    caption = \"Nota: Datos ponderados. Proporción que responde De acuerdo (4) o Muy de acuerdo (5). N = 3048.\",\n    x = \"Tramo de edad\",\n    y = \"Porcentaje de acuerdo\",\n    fill = \"Sexo\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03-graph-data-conclat_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Guardar gráfico\nggsave(\"output/graph2/c07_03_sexo_edad.png\", width = 9, height = 6, dpi = 300)\n```\n:::\n\n\n\n\n\n\n### c07_04 x sexo x edad\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calcular proporciones por sexo y edad\nacuerdo_sexo_edad <- data_svy %>%\n  filter(\n    !is.na(sexo),\n    !is.na(edad_tramos),\n    !is.na(c07_04_acuerdo)\n  ) %>%\n  group_by(edad_tramos, sexo) %>%\n  summarise(\n    prop_acuerdo = survey_mean(c07_04_acuerdo, na.rm = TRUE)\n  )\n\n# Graficar\nggplot(acuerdo_sexo_edad, aes(x = edad_tramos, y = prop_acuerdo, fill = sexo)) +\n  geom_col(position = position_dodge(width = 0.8)) +\n  geom_text(\n    aes(label = scales::percent(prop_acuerdo, accuracy = 0.1)),\n    position = position_dodge(width = 0.8),\n    vjust = 1.3,\n    color = \"white\",\n    size = 4\n  ) +\n  scale_fill_manual(values = c(\"Mujer\" = \"#f25f5c\", \"Hombre\" = \"#9e1b1e\")) +\n  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +\n  labs(\n    title = \"Acuerdo con: Redistribuir las riquezas desde quienes tienen más recursos \\nhacia quienes tienen menos recursos\",\n    subtitle = \"Porcentaje según sexo y tramo etario\",\n    caption = \"Nota: Datos ponderados. Proporción que responde De acuerdo (4) o Muy de acuerdo (5). N = 3048.\",\n    x = \"Tramo de edad\",\n    y = \"Porcentaje de acuerdo\",\n    fill = \"Sexo\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03-graph-data-conclat_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Guardar gráfico\nggsave(\"output/graph2/c07_04_sexo_edad.png\", width = 9, height = 6, dpi = 300)\n```\n:::\n\n\n\n\n\n\n### c07_05 x sexo x edad\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calcular proporciones por sexo y edad\nacuerdo_sexo_edad <- data_svy %>%\n  filter(\n    !is.na(sexo),\n    !is.na(edad_tramos),\n    !is.na(c07_05_acuerdo)\n  ) %>%\n  group_by(edad_tramos, sexo) %>%\n  summarise(\n    prop_acuerdo = survey_mean(c07_05_acuerdo, na.rm = TRUE)\n  )\n\n# Graficar\nggplot(acuerdo_sexo_edad, aes(x = edad_tramos, y = prop_acuerdo, fill = sexo)) +\n  geom_col(position = position_dodge(width = 0.8)) +\n  geom_text(\n    aes(label = scales::percent(prop_acuerdo, accuracy = 0.1)),\n    position = position_dodge(width = 0.8),\n    vjust = 1.3,\n    color = \"white\",\n    size = 4\n  ) +\n  scale_fill_manual(values = c(\"Mujer\" = \"#f25f5c\", \"Hombre\" = \"#9e1b1e\")) +\n  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +\n  labs(\n    title = \"Acuerdo con: Promover la igualdad entre hombres y mujeres\",\n    subtitle = \"Porcentaje según sexo y tramo etario\",\n    caption = \"Nota: Datos ponderados. Proporción que responde De acuerdo (4) o Muy de acuerdo (5). N = 3048.\",\n    x = \"Tramo de edad\",\n    y = \"Porcentaje de acuerdo\",\n    fill = \"Sexo\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03-graph-data-conclat_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Guardar gráfico\nggsave(\"output/graph2/c07_05_sexo_edad.png\", width = 9, height = 6, dpi = 300)\n```\n:::\n\n\n\n\n\n\n### c07_06 x sexo x edad\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calcular proporciones por sexo y edad\nacuerdo_sexo_edad <- data_svy %>%\n  filter(\n    !is.na(sexo),\n    !is.na(edad_tramos),\n    !is.na(c07_06_acuerdo)\n  ) %>%\n  group_by(edad_tramos, sexo) %>%\n  summarise(\n    prop_acuerdo = survey_mean(c07_06_acuerdo, na.rm = TRUE)\n  )\n\n# Graficar\nggplot(acuerdo_sexo_edad, aes(x = edad_tramos, y = prop_acuerdo, fill = sexo)) +\n  geom_col(position = position_dodge(width = 0.8)) +\n  geom_text(\n    aes(label = scales::percent(prop_acuerdo, accuracy = 0.1)),\n    position = position_dodge(width = 0.8),\n    vjust = 1.3,\n    color = \"white\",\n    size = 4\n  ) +\n  scale_fill_manual(values = c(\"Mujer\" = \"#f25f5c\", \"Hombre\" = \"#9e1b1e\")) +\n  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +\n  labs(\n    title = \"Acuerdo con: Garantizar la educación universitaria pública y gratuita\",\n    subtitle = \"Porcentaje según sexo y tramo etario\",\n    caption = \"Nota: Datos ponderados. Proporción que responde De acuerdo (4) o Muy de acuerdo (5). N = 3048.\",\n    x = \"Tramo de edad\",\n    y = \"Porcentaje de acuerdo\",\n    fill = \"Sexo\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03-graph-data-conclat_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Guardar gráfico\nggsave(\"output/graph2/c07_06_sexo_edad.png\", width = 9, height = 6, dpi = 300)\n```\n:::\n\n\n\n\n\n\n### pol_id x sexo x edad\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calcular proporciones por sexo y edad\npol_id_sexo_edad <- data_svy %>%\n  filter(\n    !is.na(sexo),\n    !is.na(edad_tramos),\n    !is.na(pol_id)\n  ) %>%\n  group_by(edad_tramos, sexo, pol_id) %>%\n  summarise(prop = survey_mean(na.rm = TRUE)) %>%\n  ungroup()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: There was 1 warning in `dplyr::summarise()`.\nℹ In argument: `prop = survey_mean(na.rm = TRUE)`.\nℹ In group 1: `edad_tramos = 18-24`, `sexo = Hombre`, `pol_id = Izquierda`.\nCaused by warning:\n! na.rm argument has no effect on survey_mean when calculating grouped proportions. \nThis warning is displayed once per session.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Graficar\ngrafico <- ggplot(pol_id_sexo_edad, aes(x = edad_tramos, y = prop, fill = pol_id)) +\n  geom_col(position = \"fill\", color = \"white\") +\n  geom_text(\n    aes(label = ifelse(prop > 0.04, paste0(round(prop * 100, 1), \"%\"), \"\")),  # mostrar solo si es >4%\n    position = position_fill(vjust = 0.5),\n    color = \"white\",\n    size = 3.5\n  ) +\n  facet_wrap(~sexo) +\n  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +\n  scale_fill_manual(\n    values = c(\n      \"Izquierda\" = \"#6f0000\",\n      \"Centro\" = \"#9e1b1e\",\n      \"Derecha\" = \"#ca0000\",\n      \"No se identifica\" = \"#ff5651\"\n  )) +\n  labs(\n    title = \"Identificación política\",\n    subtitle = \"Porcentajes según sexo y tramo etario\",\n    x = \"Tramo de edad\",\n    y = \"Porcentaje\",\n    fill = \"Identificación política\",\n    caption = \"Nota: Datos ponderados. N = 3048.\"\n  ) +\n  theme_minimal()\n\ngrafico\n```\n\n::: {.cell-output-display}\n![](03-graph-data-conclat_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"output/graph2/pol_id_sexo_edad.png\", plot = grafico, width = 10, height = 6, dpi = 300)\n```\n:::\n\n\n\n\n\n\n### politizado x sexo x edad\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npolitizacion <- data_svy %>%\n  filter(!is.na(politizado),\n         !is.na(sexo),\n         !is.na(edad_tramos)) %>%\n  group_by(edad_tramos, sexo) %>%\n  summarise(prop = survey_mean(politizado,na.rm = TRUE)) %>%\n  ungroup()\n\nggplot(politizacion, aes(x = edad_tramos, y = prop, fill = sexo)) +\n  geom_col(position = position_dodge(width = 0.8)) +\n  geom_text(\n    aes(label = paste0(round(prop * 100, 1), \"%\")),\n    position = position_dodge(width = 0.8),\n    vjust = -0.5,\n    color = \"black\",\n    size = 4\n  ) +\n  scale_y_continuous(labels = scales::percent_format(accuracy = 1), limits = c(0, 1)) +\n  scale_fill_manual(values = c(\"Mujer\" = \"#f25f5c\", \"Hombre\" = \"#9e1b1e\")) +\n  labs(\n    title = \"Porcentaje de personas politizadas\",\n    subtitle = \"Según sexo y tramo etario\",\n    x = \"Tramo de edad\",\n    y = \"Porcentaje de personas politizadas\",\n    fill = \"Sexo\",\n    caption = \"Nota: Datos ponderados. Politización definida como hablar de política (4–5) y confiar en partidos (3–5). N = 3048.\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](03-graph-data-conclat_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"output/graph2/politizacion_sexo_edad.png\", width = 10, height = 6, dpi = 300)\n```\n:::\n\n\n\n\n\n\n### clases 1 x sexo x edad\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calcular proporciones por sexo y edad\nclass1_sexo_edad <- data_svy %>%\n  filter(\n    !is.na(sexo),\n    !is.na(edad_tramos),\n    !is.na(wrightclass1_reduced)\n  ) %>%\n  group_by(edad_tramos, sexo, wrightclass1_reduced) %>%\n  summarise(prop = survey_mean(na.rm = TRUE)) %>%\n  ungroup()\n\n# Graficar\ngrafico <- ggplot(class1_sexo_edad, aes(x = edad_tramos, y = prop, fill = wrightclass1_reduced)) +\n  geom_col(position = \"fill\", color = \"white\") +\n  geom_text(\n    aes(label = ifelse(prop > 0.04, paste0(round(prop * 100, 1), \"%\"), \"\")),  # mostrar solo si es >4%\n    position = position_fill(vjust = 0.5),\n    color = \"white\",\n    size = 3.5\n  ) +\n  facet_wrap(~sexo) +\n  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +\n  scale_fill_manual(\n    values = c(\n      \"1. Formal workers\" = \"#6f0000\",\n      \"2. Informal workers\" = \"#9e1b1e\",\n      \"3. Informal self-employed\" = \"#ca0000\",\n      \"4. Experts\" = \"#ff5651\",\n      \"5. Supervisors\" =\"#b23a48\",\n      \"6. Managers\" = \"#8c1d40\",\n      \"7. Petty bourgeoisie\" = \"#d1eaf3\",\n      \"8. Small employers\" = \"#0f6481\",\n      \"9. Employers\" = \"#083342\"\n  )) +\n  labs(\n    title = \"Clases\",\n    subtitle = \"Porcentajes según sexo y tramo etario\",\n    x = \"Tramo de edad\",\n    y = \"Porcentaje\",\n    fill = \"Clases\",\n    caption = \"Nota: Datos ponderados. N = 3048.\"\n  ) +\n  theme_minimal()\n\ngrafico\n```\n\n::: {.cell-output-display}\n![](03-graph-data-conclat_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"output/graph2/class1_sexo_edad.png\", plot = grafico, width = 10, height = 6, dpi = 300)\n```\n:::\n\n\n\n\n\n\n### clases 2 x sexo x edad\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calcular proporciones por sexo y edad\nclass2_sexo_edad <- data_svy %>%\n  filter(\n    !is.na(sexo),\n    !is.na(edad_tramos),\n    !is.na(wrightclass2_reduced)\n  ) %>%\n  group_by(edad_tramos, sexo, wrightclass2_reduced) %>%\n  summarise(prop = survey_mean(na.rm = TRUE)) %>%\n  ungroup()\n\n# Graficar\ngrafico <- ggplot(class2_sexo_edad, aes(x = edad_tramos, y = prop, fill = wrightclass2_reduced)) +\n  geom_col(position = \"fill\", color = \"white\") +\n  geom_text(\n    aes(label = ifelse(prop > 0.04, paste0(round(prop * 100, 1), \"%\"), \"\")),  # mostrar solo si es >4%\n    position = position_fill(vjust = 0.5),\n    color = \"white\",\n    size = 3.5\n  ) +\n  facet_wrap(~sexo) +\n  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +\n  scale_fill_manual(\n    values = c(\n      \"1. Formal workers\" = \"#6f0000\",\n      \"2. Informal workers\" = \"#9e1b1e\",\n      \"3. Informal self-employed\" = \"#ca0000\",\n      \"4. Experts\" = \"#ff5651\",\n      \"5. Supervisors\" =\"#b23a48\",\n      \"6. Managers\" = \"#8c1d40\",\n      \"7. Petty bourgeoisie\" = \"#d1eaf3\",\n      \"8. Small employers\" = \"#0f6481\",\n      \"9. Capitalists\" = \"#083342\"\n  )) +\n  labs(\n    title = \"Clases 2\",\n    subtitle = \"Porcentajes según sexo y tramo etario\",\n    x = \"Tramo de edad\",\n    y = \"Porcentaje\",\n    fill = \"Clases 2\",\n    caption = \"Nota: Datos ponderados. N = 3048.\"\n  ) +\n  theme_minimal()\n\ngrafico\n```\n\n::: {.cell-output-display}\n![](03-graph-data-conclat_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"output/graph2/class2_sexo_edad.png\", plot = grafico, width = 10, height = 6, dpi = 300)\n```\n:::\n",
    "supporting": [
      "03-graph-data-conclat_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}